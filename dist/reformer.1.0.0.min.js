!function(e){if("function"==typeof bootstrap)bootstrap("reformer",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeReformer=e}else"undefined"!=typeof window?window.Reformer=e():global.Reformer=e()}(function(){var define;return function(e,t,i){function n(i,a){if(!t[i]){if(!e[i]){var s="function"==typeof require&&require;if(!a&&s)return s(i,!0);if(r)return r(i,!0);throw new Error("Cannot find module '"+i+"'")}var l=t[i]={exports:{}};e[i][0].call(l.exports,function(t){var r=e[i][1][t];return n(r?r:t)},l,l.exports)}return t[i].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(){},{}],2:[function(e,t){function i(e){if("string"!=typeof e)throw new TypeError("String expected");var t=/<([\w:]+)/.exec(e);if(!t)throw new Error("No elements were generated.");var i=t[1];if("body"==i){var r=document.createElement("html");return r.innerHTML=e,r.removeChild(r.lastChild)}var a=n[i]||n._default,s=a[0],l=a[1],o=a[2],r=document.createElement("div");for(r.innerHTML=l+e+o;s--;)r=r.lastChild;var u=r.children;if(1==u.length)return r.removeChild(u[0]);for(var f=document.createDocumentFragment();u.length;)f.appendChild(r.removeChild(u[0]));return f}t.exports=i;var n={option:[1,'<select multiple="multiple">',"</select>"],optgroup:[1,'<select multiple="multiple">',"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tbody:[1,"<table>","</table>"],tfoot:[1,"<table>","</table>"],colgroup:[1,"<table>","</table>"],caption:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:[0,"",""]}},{}],3:[function(e,t){function i(e,t,i){if(!e.length)return i();var n=0;e.forEach(function(r){t(r,function(t){t?(i(t),i=function(){}):(n+=1,n===e.length&&i())})})}function n(e){return e&&e.trim?e.trim():""}function r(e){var t,i=this,n=function(){};this.settings={error:n,submit:n,reqMessage:"This field is required",html5Validation:!0},this.fieldDefinition=e.fields,this.fields=[],this.id=e.id,this.formEl=e.formEl,this.fieldContainer=e.fieldContainer,this.submitText=e.submitText,this.initialData=e.data||{},delete e.fields;for(t in e)this.settings[t]=e[t];this.fieldDefinition.forEach(function(e){e.parent=i,i.fields.push(new a(e))})}function a(e){var t,i=e.parent.initialData;this.errors=[],this.type="text",this.tests=[],this.textarea="textarea"===e.widget,this.select="select"===e.widget&&e.hasOwnProperty("options"),this.input=e.hasOwnProperty("widget")?"input"===e.widget:!0,this.trim=!0;for(t in e)this[t]=e[t];if(this.id=e.id||e.name,!this.id)throw new Error("All fields need either a name or id attribute");this.containerEl=function(){var t=typeof e.containerEl;return"string"===t?document.getElementById(e.containerEl):"object"===t?e.containerEl:void 0}(),this.containerId=this.containerEl&&this.containerEl.id||this.id+"_parent",this.value=this.initial=i&&i.hasOwnProperty(this.name)?i[this.name]:""}var s=e("./templates"),l=e("domify");r.prototype.render=function(e){var t=e||{};return t.formEl&&(this.formEl=t.formEl),t.fieldContainer&&(this.fieldContainer=t.fieldContainer),this.rendered||(this.formEl.addEventListener("submit",function(e){e.preventDefault()},!0),this.addButtonHandlers()),this.rendered=!0,this.fields.forEach(function(e){e.render()}),this.formEl},r.prototype.addButtonHandlers=function(){for(var e=this,t=this.formEl.getElementsByTagName("button",this.dom),i=0,n=t.length;n>i;i++)t[i].addEventListener("click",function(t){var i,n=t.target.className;return e.submitRe.test(n)||"submit"===t.target.type?(e.handleSubmit(),t.stopPropagation(),!1):(i=e.settings[n])?(t.preventDefault(),t.stopPropagation(),i(),!1):void 0},!0)},r.prototype.handleSubmit=function(){var e=this;e.settings.preSubmit&&e.settings.preSubmit.call(e),this.validate(function(t){if(e.render(),t){var i=e.data();e.settings.submit(i,e.diffData(i))}else e.settings.error(e)})},r.prototype.data=function(){var e={};return this.fields.forEach(function(t){e[t.name]=t.trim?n(t.value):t.value}),this.settings.clean&&(e=this.settings.clean(e)),e},r.prototype.diffData=function(e){var t,i=this.initialData,n={};for(var r in e)e[r]!==i[r]&&(t=!0,n[r]=e[r]);return t?n:void 0},r.prototype.clearAll=function(){return this.fields.forEach(function(e){e.inputEl.value="",e.errors=[]}),!0},r.prototype.validate=function(e){var t=!0;i(this.fields,function(e,i){e.validate(function(e){e||(t=!1),i()})},function(){e(t)})},r.prototype.submitRe=/(^|\s)submit(\s|$)/,a.prototype.render=function(){var e,t=l(s.field({field:this}));"string"==typeof this.fieldContainer&&(this.fieldContainer=this.parent.formEl.querySelector("#"+this.fieldContainer)),this.fieldContainer?(e=this.fieldContainer.parentNode,e.replaceChild(t,this.fieldContainer),this.fieldContainer=t):(this.fieldContainer=t,this.parent.fieldContainer.appendChild(t)),this.inputEl=this.fieldContainer.querySelector('[name="'+this.name+'"]'),this.labelEl=this.fieldContainer.querySelector('label[for="'+this.id+'"]'),this.inputEl.value=(this.value||"")+"",this.registerHandlers(),this.rendered=!0},a.prototype.registerHandlers=function(){var e=this;this.inputEl.addEventListener("input",function(){e.handleInputChange.apply(e,arguments)},!0),this.inputEl.addEventListener("blur",function(){e.handleInputChange.apply(e,arguments)},!0),this.inputEl.addEventListener("change",function(){e.handleInputChange.apply(e,arguments)},!0),this.inputEl.addEventListener("invalid",function(e){e.preventDefault()},!0)},a.prototype.handleInputChange=function(){var e=this.inputEl,t=this.type;this.value=function(){return-1!==["range","number"].indexOf(t)?e.valueAsNumber:"date"===t?e.valueAsDate:e.value}()},a.prototype.validate=function(e){var t=this,n=this.tests instanceof Array?this.tests:[this.tests],r=!0;this.errors=[],!this.required||this.value&&0!==this.value.length||(r=!1,this.errors.push(this.reqMessage||this.parent.settings.reqMessage)),this.parent.settings.html5Validation&&this.inputEl.validationMessage&&(r=!1,this.errors.push(this.inputEl.validationMessage)),i(n,function(e,i){var n=!1;e.ignoreSame&&t.value===t.initial?i(null):e.async?e.test.call(t,t.value,t,function(n){n||(r=!1,t.errors.push(e.message)),i(null,n)}):(n=e.test.call(t,t.value,t),n||(r=!1,t.errors.push(e.message)),i(null,n))},function(){e(r)})},a.prototype.get=function(e,t){var i=t||null;return"undefined"==typeof this[e]?i:this[e]},t.exports=r},{"./templates":4,domify:2}],4:[function(require,module,exports){!function(){var root=this,exports={},jade=function(e){function t(e){return null!=e}return Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Object.keys||(Object.keys=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}),e.merge=function(e,i){var n=e["class"],r=i["class"];(n||r)&&(n=n||[],r=r||[],Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]),n=n.filter(t),r=r.filter(t),e["class"]=n.concat(r).join(" "));for(var a in i)"class"!=a&&(e[a]=i[a]);return e},e.attrs=function(t,i){var n=[],r=t.terse;delete t.terse;var a=Object.keys(t),s=a.length;if(s){n.push("");for(var l=0;s>l;++l){var o=a[l],u=t[o];"boolean"==typeof u||null==u?u&&(r?n.push(o):n.push(o+'="'+o+'"')):0==o.indexOf("data")&&"string"!=typeof u?n.push(o+"='"+JSON.stringify(u)+"'"):"class"==o&&Array.isArray(u)?n.push(o+'="'+e.escape(u.join(" "))+'"'):i&&i[o]?n.push(o+'="'+e.escape(u)+'"'):n.push(o+'="'+u+'"')}}return n.join(" ")},e.escape=function(e){return String(e).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.rethrow=function(e,t,i){if(!t)throw e;var n=3,r=require("fs").readFileSync(t,"utf8"),a=r.split("\n"),s=Math.max(i-n,0),l=Math.min(a.length,i+n),n=a.slice(s,l).map(function(e,t){var n=t+s+1;return(n==i?"  > ":"    ")+n+"| "+e}).join("\n");throw e.path=t,e.message=(t||"Jade")+":"+i+"\n"+n+"\n\n"+e.message,e},e}({});exports.field=function anonymous(locals){var buf=[];with(locals||{})buf.push("<div"+jade.attrs({id:field.containerId,"class":"fieldContainer clearfix"+(field.errors.length?" error":"")},{id:!0,"class":!0})+">"),function(){var e=field.errors;if("number"==typeof e.length)for(var t=0,i=e.length;i>t;t++){var n=e[t];buf.push('<span class="error">'+(null==(jade.interp=n)?"":jade.interp)+"</span>")}else{var i=0;for(var t in e)if(i++,e.hasOwnProperty(t)){var n=e[t];buf.push('<span class="error">'+(null==(jade.interp=n)?"":jade.interp)+"</span>")}}}.call(this),field.label&&buf.push("<label"+jade.attrs({"for":field.id},{"for":!0})+">"+jade.escape(null==(jade.interp=field.label)?"":jade.interp)+"</label>"),field.textarea&&buf.push("<textarea"+jade.attrs({id:field.id,name:field.name,placeholder:field.placeholder},{id:!0,name:!0,placeholder:!0})+"></textarea>"),field.input&&buf.push("<input"+jade.attrs({id:field.id,min:field.get("min"),max:field.get("max"),step:field.get("step"),placeholder:field.get("placeholder"),type:field.type,name:field.name},{id:!0,min:!0,max:!0,step:!0,placeholder:!0,type:!0,name:!0})+"/>"),field.select&&(buf.push("<select"+jade.attrs({id:field.id,name:field.name,"class":field.class},{id:!0,name:!0,"class":!0})+">"),function(){var e=field.options;if("number"==typeof e.length)for(var t=0,i=e.length;i>t;t++){var n=e[t];buf.push("<option"+jade.attrs({value:n.val},{value:!0})+">"+jade.escape(null==(jade.interp=n.text)?"":jade.interp)+"</option>")}else{var i=0;for(var t in e)if(i++,e.hasOwnProperty(t)){var n=e[t];buf.push("<option"+jade.attrs({value:n.val},{value:!0})+">"+jade.escape(null==(jade.interp=n.text)?"":jade.interp)+"</option>")}}}.call(this),buf.push("</select>")),field.helpText&&buf.push("<p"+jade.attrs({id:field.id+"_helpText","class":"helpText"},{id:!0})+">"+jade.escape(null==(jade.interp=field.helpText)?"":jade.interp)+"</p>"),buf.push("</div>");return buf.join("")},exports.form=function anonymous(locals){var buf=[];with(locals||{})buf.push('<form><div class="fields"></div><button type="submit">Submit</button><button type="reset">Cancel</button></form>');return buf.join("")},"undefined"!=typeof module?module.exports=exports:"function"==typeof define&&define.amd?define(exports):root.templatizer=exports}()},{fs:1}]},{},[3])(3)});